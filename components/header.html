<!-- components/header.html -->
<header class="bg-blue-900 text-white sticky top-0 z-50 shadow"
        x-data="{ open:false, showSearch:false }">
  <div class="relative max-w-7xl mx-auto px-4 h-14 flex items-center justify-between">
    
    <!-- Left: Logo -->
    <div class="flex items-center gap-3">
      <a href="/index.html" class="transition-transform hover:scale-[1.05] flex items-center">
        <img src="/SFP-Logo.png" alt="Safe Freight Program" class="h-9 w-auto">
      </a>
    </div>

    <!-- Center: Page title -->
    <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
      <div id="page-title" class="hidden text-base sm:text-lg font-semibold opacity-95"></div>
    </div>

    <!-- Right: Controls -->
    <div class="flex items-center gap-1">
      <!-- Search toggle -->
      <button @click="showSearch=!showSearch"
              class="inline-flex items-center justify-center h-9 w-9 rounded-md hover:bg-white/10 focus:outline-none"
              aria-label="Search">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
             viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M21 21l-4.35-4.35M10 18a8 8 0 110-16 8 8 0 010 16z"/>
        </svg>
      </button>

      <!-- Account indicator placeholder (filled by /js/account-indicator.js) -->
      <div id="account-indicator" class="relative"></div>

      <!-- Hamburger -->
      <button @click="open=!open"
              class="inline-flex items-center justify-center h-9 w-9 rounded-md hover:bg-white/10 focus:outline-none"
              :aria-expanded="open.toString()" aria-label="Menu">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
             viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Search bar -->
  <div x-show="showSearch" x-transition
       class="bg-blue-900/95 border-t border-white/10">
    <div class="max-w-7xl mx-auto px-4 py-2">
      <input type="search" placeholder="Type a word"
             class="w-full rounded-md px-3 py-2 text-sm text-gray-900"
             onkeydown="if(event.key==='Enter'){window.location.href='/search.html?q='+encodeURIComponent(this.value)}">
    </div>
  </div>

  <!-- Mobile menu -->
  <nav x-show="open" x-transition.opacity
       class="lg:hidden bg-blue-900/95 backdrop-blur border-t border-white/10">
    <div class="max-w-7xl mx-auto px-4 py-3 space-y-1">
      <a href="/about.html" class="block px-3 py-2 rounded hover:bg-white/10">About</a>
      <a href="/lookup-driver.html" class="block px-3 py-2 rounded hover:bg-white/10">Driver Lookup</a>
      <a href="/lookup-vehicle.html" class="block px-3 py-2 rounded hover:bg-white/10">Vehicle Lookup</a>
      <a href="/find-ail.html" class="block px-3 py-2 rounded hover:bg-white/10">Find AIL</a>
      <a href="/training.html" class="block px-3 py-2 rounded hover:bg-white/10">SFP Training</a>
      <a href="/ail-portal.html" class="block px-3 py-2 rounded hover:bg-white/10">AIL Portal</a>
      <a href="/trainer-login.html" class="block px-3 py-2 rounded hover:bg-white/10">Trainer Login</a>
      <a href="/contact.html" class="block px-3 py-2 rounded hover:bg-white/10">Contact</a>
      <a href="/subscribe.html" class="block px-3 py-2 rounded hover:bg-white/10">Subscribe</a>
      <a href="/admin.html" data-requires-role="admin" class="hidden block px-3 py-2 rounded hover:bg-white/10">Admin</a>
    </div>
  </nav>
</header>

<!-- Scripts -->
<script src="/js/sfp-api.js"></script>
<script src="/js/account-indicator.js"></script>
<script>
/* Inject Admin link into account dropdown if role=admin */
window.addEventListener("sfp-auth-changed", function(e) {
  const role = (e.detail.role || "").toLowerCase();
  const acctMenu = document.querySelector("#account-indicator #acctMenu");
  if (acctMenu && role === "admin" && !acctMenu.querySelector(".admin-link")) {
    const adminLink = document.createElement("a");
    adminLink.href = "/admin.html";
    adminLink.textContent = "Admin";
    adminLink.className = "admin-link block px-4 py-2 hover:bg-gray-50";
    acctMenu.insertBefore(adminLink, acctMenu.lastElementChild); // before Sign out
  }
});
</script>
